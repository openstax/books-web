clean: clean-eggs clean-pyc clean-test

clean-eggs: ## remove build artifacts
	rm -fr .eggs/
	find . -name '*.egg-info' -exec rm -fr {} +
	find . -name '*.egg' -exec rm -f {} +

clean-pyc: ## remove Python file artifacts
	find . -name '*.pyc' -exec rm -f {} +
	find . -name '*.pyo' -exec rm -f {} +
	find . -name '*~' -exec rm -f {} +
	find . -name '__pycache__' -exec rm -fr {} +

clean-test: ## remove test and coverage artifacts
	rm -fr .tox/
	rm -fr assets/
	rm -f report.html

venv:
	python3 -m venv .venv && \
		source .venv/bin/activate && \
		pip install -r pytest-selenium/requirements-dev.txt

help_redirect:
	@$(MAKE) help --no-print-directory

test: venv
	@source .venv/bin/activate && pytest \
		--testrail \
		--tr-url="https://openstax.testrail.com/" \
		--tr-email=$(TR_EMAIL) \
		--tr-password=$(TR_PASSWORD) \
		--tr-testrun-project-id=11 \
		--tr-plan-id=650 \
	  --tr-run-id=652 \
		--tr-testrun-suite-id=487 \
		--tr-skip-missing \
		--base-url=http://localhost:3000 \
		--driver Chrome \
		pytest-selenium/tests

test-local: venv
	@source .venv/bin/activate && pytest \
		--base-url http://localhost:3000 \
		--driver Chrome \
		pytest-selenium/tests \

help_submake:
	@echo "The following targets are available"
	@echo "  clean		Remove build, test, and file artifacts"
	@echo "  clean-build	Remove build artifacts"
	@echo "  clean-pyc	Remove file artifacts"
	@echo "  clean-test	Remove test artifacts"
	@echo "  venv		Set up a virtualenv for this project"
	@echo "  test		Run test suite"
